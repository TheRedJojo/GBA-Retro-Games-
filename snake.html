<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>PixelSnake - GBA (NES)</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<link rel="website icon" type="png" href="img/SNAKE.png">
<style>
  :root{
    --bg:#081018;
    --panel:#0f1724;
    --accent:#FFD27F;
    --muted:#9AA6B2;
    --text:#EAE6DA;
  }
  html, body {
    margin:0; padding:0;
    height:100%; width:100%;
    overflow:hidden;
    font-family:'Press Start 2P',monospace;
    background: linear-gradient(180deg,var(--bg),#07101a);
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    touch-action:none;
    -webkit-user-select:none; user-select:none;
  }
  .wrapper{
    width:95vw;
    max-width:420px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
    border:4px solid #000;
    border-radius:8px;
    padding:12px;
    display:flex; flex-direction:column; align-items:center;
    gap:12px;
  }
  .logo{color:var(--accent); font-size:12px; text-align:center;}
  .controls{
    display:flex; justify-content:center; gap:8px; flex-wrap:wrap; margin-top:6px;
  }
  .btn{
    flex:1 1 45%;
    padding:12px 10px;
    background:#111; border:3px solid #000;
    color:var(--text); text-align:center;
    border-radius:6px; cursor:pointer; font-size:11px;
  }
  .btn:hover{background:var(--accent); color:#000; transform:translateY(-2px);}
  .canvasWrap{
    width:100%;
    position:relative;
    border:3px solid #000;
    border-radius:6px;
    padding:6px;
    background:#07101a;
  }
  canvas{
    width:100%; height:auto; display:block; background:#111;
    border:2px solid #000;
    image-rendering:pixelated;
  }
  .hud{
    width:100%; margin-top:6px;
    color:var(--text); font-size:12px;
    display:flex; flex-direction:column; align-items:center; gap:4px;
  }
  #message{color:var(--accent); min-height:20px; text-align:center;}
  .footer,.credits{
    font-size:10px; color:var(--muted);
    position:fixed;
  }
  .footer{bottom:25px;align-items: center;}
  .credits{bottom:4px;align-items: center;}
  .scan{position:fixed; inset:0; pointer-events:none;
        background-image:linear-gradient(rgba(0,0,0,0.03) 50%, transparent 51%);
        background-size:100% 4px; opacity:0.35;}
</style>
</head>
<body>

<div class="wrapper">
  <div class="logo">GBA — PixelSnake</div>

  <div class="canvasWrap">
    <canvas id="game" width="300" height="300"></canvas>
  </div>

  <div class="hud">
    <div>Punteggio: <span id="score">0</span></div>
    <div>Record: <span id="hs">0</span></div>
    <div id="message"></div>
  </div>

  <div class="controls">
    <div class="btn" id="btnRestart">RIAVVIA</div>
    <div class="btn" id="btnMenu" onclick="location.href='index.html'">MENU</div>
  </div>

  <div style="font-size:11px;color:var(--muted);margin-top:4px;text-align:center;">Controlli: frecce (PC) / swipe (touch)</div>
</div>

<div class="scan"></div>
<div class="footer">Versione Beta (1.0.0)</div>
<div class="credits">Fatto da Anto e ChatGPT</div>

<script>
/* PixelSnake logic, unchanged */
const canvas=document.getElementById('game'), ctx=canvas.getContext('2d');
const GRID=15;
let snake=[], dir={x:0,y:0}, food={x:0,y:0}, score=0;
let hs = parseInt(localStorage.getItem('gba_snake_hs')||0);
let running=false, over=false, tick=140, timer=null;
const scoreEl=document.getElementById('score'), hsEl=document.getElementById('hs'), msg=document.getElementById('message');
hsEl.textContent = hs;

function randPos(){ return { x: Math.floor(Math.random()*(canvas.width/GRID)), y: Math.floor(Math.random()*(canvas.height/GRID)) }; }
function placeFood(){ food=randPos(); for(let s of snake){ if(s.x===food.x && s.y===food.y){ food=randPos(); } } }
function reset(initStart=false){ snake=[{x:10,y:10}]; dir={x:0,y:0}; score=0; over=false; running=false; msg.textContent=''; placeFood(); render(); if(initStart) startLoop(); }
function startLoop(){ if(timer) clearInterval(timer); timer=setInterval(loop, tick); running=true; }
function render(){ ctx.fillStyle='#081018'; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.fillStyle='#FFD27F'; ctx.fillRect(food.x*GRID, food.y*GRID, GRID, GRID); ctx.fillStyle='#8EE5A6'; for(let s of snake) ctx.fillRect(s.x*GRID, s.y*GRID, GRID, GRID); scoreEl.textContent=score; hsEl.textContent=hs; }
function endGame(){ over=true; running=false; clearInterval(timer); msg.textContent='Hai perso — punteggio: '+score; setTimeout(()=>{ reset(true); },1400); }
function loop(){ if(!running||over) return; const head={x:snake[0].x+dir.x, y:snake[0].y+dir.y}; if(head.x<0||head.y<0||head.x>=canvas.width/GRID||head.y>=canvas.height/GRID){ endGame(); return; } for(let i=1;i<snake.length;i++){ if(snake[i].x===head.x && snake[i].y===head.y){ endGame(); return; } } snake.unshift(head); if(head.x===food.x && head.y===food.y){ score++; if(score>hs){ hs=score; localStorage.setItem('gba_snake_hs',hs); msg.textContent='Nuovo record: '+hs; } placeFood(); }else{ snake.pop(); } render(); }

document.addEventListener('keydown',e=>{ if(e.key==='ArrowUp'&&dir.y!==1)dir={x:0,y:-1}; if(e.key==='ArrowDown'&&dir.y!==-1)dir={x:0,y:1}; if(e.key==='ArrowLeft'&&dir.x!==1)dir={x:-1,y:0}; if(e.key==='ArrowRight'&&dir.x!==-1)dir={x:1,y:0}; if(!running&&!over) startLoop(); });

let sx=0, sy=0;
canvas.addEventListener('touchstart', e=>{ const t=e.touches[0]; sx=t.clientX; sy=t.clientY; }, {passive:true});
canvas.addEventListener('touchend', e=>{ const t=e.changedTouches[0]; const dx=t.clientX-sx, dy=t.clientY-sy; if(Math.abs(dx)>Math.abs(dy)){ if(dx>0 && dir.x!==-1) dir={x:1,y:0}; if(dx<0 && dir.x!==1) dir={x:-1,y:0}; } else { if(dy>0 && dir.y!==-1) dir={x:0,y:1}; if(dy<0 && dir.y!==1) dir={x:0,y:-1}; } if(!running&&!over) startLoop(); }, {passive:true});

document.getElementById('btnRestart').addEventListener('click',()=>{ reset(true); });
reset(true); render();
</script>
</body>
</html>
